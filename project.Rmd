```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, dev="httpgd", fig.show="hold")
```

```{r}
library(dplyr)
library(tseries)
library(forecast)
```

```{r}
gold <- read.csv("Gold Price.csv")
```

```{r}
gold$Date <- as.Date(gold$Date)
gold <- gold[order(gold$Date),]
```

```{r}
head(gold)
```

Data preparation
```{r}
#gold price statistics
summary(gold$Price)
```

```{r}
# check if there is missing value
sum(is.na(gold))

# detect outliers using IQR
boxplot(gold$Price, main="Gold Price Boxplot", col="lightblue")

Q1 <- quantile(gold$Price, 0.25)
Q3 <- quantile(gold$Price, 0.75)
IQR_value <- Q3 - Q1

lower_bound <- Q1 - 1.5 * IQR_value
upper_bound <- Q3 + 1.5 * IQR_value

outliers <- gold$Price[gold$Price < lower_bound | gold$Price > upper_bound]
print(outliers)

```

```{r}
plot(gold$Date, gold$Price)
```
From the plot of the gold price, the plot seems not stationary because the trend of the price is increasing.

Check stationary using Augmented Dickey-Fuller (ADF test):
```{r}
adf.test(gold$Price)
```
By the Augmented Dickey-Fuller Test, the p-value is greater then alpha=0.05, which means we don't have enough evidence to reject that the data is not stationary. 

Make it stationary using Differencing to remove the main trend

```{r}
# check symmetry
hist(gold$Price, main = "Histogram of the Gold Price", xlab = "Gold Price")
```
The histogram is right skewed.Try log transformation.

```{r}
#log transformation
gold$logPrice <- log(gold$Price)

#check symmetry
hist(gold$logPrice, main = "Histogram of Log Gold Price", xlab = "Log of Gold Price")
```
```{r}
#adf test after log transformation
adf.test(gold$logPrice)
```
Log transformation does not perform well. Try BoxCox transformation.

```{r}
#BoxCox transformation
lambda = BoxCox.lambda(gold$Price)
print(paste("best lambda is:" ,lambda))
```
```{r}
gold$boxcox = BoxCox(gold$Price, lambda = lambda)
hist(gold$boxcox, main = "histogram of BoxCox transformation")
```
```{r}
#adf test after boxcox transformation
adf.test(gold$boxcox)
```
BoxCox transformation dose not works well. However, p-value decreases from 0.9002 to 0.3328 and the right skewed trend is weakened. We choose to retain BoxCox transformation.

```{r}
#basic information
n = nrow(gold)
y_start = 2014
m_start = 1
ts = ts(gold$Price, start = c(y_start, m_start), frequency = 12)

#classical decomposition
gold_decomp <- decompose(ts, type = "additive")
plot(gold_decomp$trend)
```
```{r}
plot(gold_decomp$seasonal)
```
```{r}
plot(gold_decomp$random)
```
```{r}
#adf test after classical decomposition
adf.test(na.omit(gold_decomp$random))
```










Data Analysis
- Initial data transformations
```{r}
# Check stabilize variance by using the ACF plot
gold_ts = ts(gold$diff_price[-1])
acf(gold_ts, main = "ACF plot of Gold Price")
pacf(gold_ts, main = "PACF plot of Gold Price")
```
From the plot of ACF and PACF, there is no clear trends or fluctuations over time. The variance of time series data does not change over time and is stable. Also, by the behavior of ACF and PACF for AR, MA and ARMA processes, we observed that this might be a MA process since the ACF cuts off at some lag q and PACF tails off.


By the histogram, the data of gold price is likely normal and symmetry at 0 (mean 0).




